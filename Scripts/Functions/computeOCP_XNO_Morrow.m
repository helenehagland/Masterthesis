function [OCP, dUdT] = computeOCP_XNO_Morrow(c, T, cmax)
% Data from
%  @article{Pron_2019, title={Electrochemical Characterization and Solid Electrolyte Interface Modeling of LiNi0.5Mn1.5O4-Graphite Cells}, volume={166}, ISSN={1945-7111}, url={http://dx.doi.org/10.1149/2.0941910jes}, DOI={10.1149/2.0941910jes}, number={10}, journal={Journal of The Electrochemical Society}, publisher={The Electrochemical Society}, author={Pron, Vittorio Giai and Versaci, Daniele and Amici, Julia and Francia, Carlotta and Santarelli, Massimo and Bodoardo, Silvia}, year={2019}, pages={A2255â€“A2263} }

    Tref = 293.15;  % [K]

    % if isa(c, 'ADI')
    %     c_values = c.val;  % Extract the actual numeric values
    % else
    %     c_values = c;  % Use c directly if it's not an ADI object
    % end


    theta = c./cmax;

    % % Diagnostic print
    % disp('First few values of c:');
    % disp(c_values(1:5));

    % if any(~isreal(c_values)) || any(isnan(c_values))
    % error('c contains complex or NaN values.');
    % end


    refOCP_table = [[0.000000, 2.27110];...
                    [0.010042, 2.03180];...
                    [0.020083, 1.97010];...
                    [0.030275, 1.92170];...
                    [0.040317, 1.87990];...
                    [0.050492, 1.84730];...
                    [0.060534, 1.82180];...
                    [0.070709, 1.80030];...
                    [0.080750, 1.78170];...
                    [0.090792, 1.76540];...
                    [0.100984, 1.75070];...
                    [0.111026, 1.73760];...
                    [0.121201, 1.72500];...
                    [0.131242, 1.71340];...
                    [0.141418, 1.70330];...
                    [0.151459, 1.69500];...
                    [0.161501, 1.68830];...
                    [0.171693, 1.68360];...
                    [0.181735, 1.68090];...
                    [0.191910, 1.67920];...
                    [0.201951, 1.67750];...
                    [0.212127, 1.67650];...
                    [0.222168, 1.67490];...
                    [0.232210, 1.67360];...
                    [0.242402, 1.67230];...
                    [0.252443, 1.67100];...
                    [0.262619, 1.66970];...
                    [0.272660, 1.66840];...
                    [0.282836, 1.66680];...
                    [0.292877, 1.66540];...
                    [0.303053, 1.66400];...
                    [0.313094, 1.66250];...
                    [0.323136, 1.66060];...
                    [0.333328, 1.65870];...
                    [0.343369, 1.65620];...
                    [0.353545, 1.65370];...
                    [0.363586, 1.65100];...
                    [0.373762, 1.64770];...
                    [0.383803, 1.64410];...
                    [0.393845, 1.64030];...
                    [0.404020, 1.63620];...
                    [0.414061, 1.63200];...
                    [0.424254, 1.62770];...
                    [0.434295, 1.62340];...
                    [0.444470, 1.61890];...
                    [0.454512, 1.61430];...
                    [0.464553, 1.60980];...
                    [0.474729, 1.60500];...
                    [0.484770, 1.60020];...
                    [0.494946, 1.59500];...
                    [0.504987, 1.58980];...
                    [0.515179, 1.58420];...
                    [0.525221, 1.57820];...
                    [0.535396, 1.57180];...
                    [0.545438, 1.56510];...
                    [0.555479, 1.55820];...
                    [0.565655, 1.55070];...
                    [0.575696, 1.54290];...
                    [0.585872, 1.53440];...
                    [0.595913, 1.52570];...
                    [0.606088, 1.51710];...
                    [0.616130, 1.50790];...
                    [0.626172, 1.49850];...
                    [0.636347, 1.48850];...
                    [0.646388, 1.47860];...
                    [0.656581, 1.46860];...
                    [0.666605, 1.45860];...
                    [0.676797, 1.44810];...
                    [0.686839, 1.43790];...
                    [0.696864, 1.42780];...
                    [0.707056, 1.41680];...
                    [0.717097, 1.40660];...
                    [0.727273, 1.39630];...
                    [0.737314, 1.38600];...
                    [0.747490, 1.37570];...
                    [0.757531, 1.36470];...
                    [0.767707, 1.35510];...
                    [0.777748, 1.34490];...
                    [0.787790, 1.33530];...
                    [0.797965, 1.32530];...
                    [0.808006, 1.31550];...
                    [0.818182, 1.30560];...
                    [0.828223, 1.29570];...
                    [0.838399, 1.28580];...
                    [0.848440, 1.27590];...
                    [0.858482, 1.26550];...
                    [0.868657, 1.25480];...
                    [0.878699, 1.24310];...
                    [0.888891, 1.23020];...
                    [0.898932, 1.21680];...
                    [0.909108, 1.20220];...
                    [0.919149, 1.18740];...
                    [0.929191, 1.17190];...
                    [0.939366, 1.15750];...
                    [0.949408, 1.14520];...
                    [0.959583, 1.13470];...
                    [0.969624, 1.12600];...
                    [0.979800, 1.11720];...
                    [0.989841, 1.10910];...
                    [1.000000, 1.10000]];


    refOCP = interpTable(refOCP_table(:, 1), refOCP_table(:, 2), theta);
    
    dUdT_table = [[0e-2 ,  -0.06e-3]; ...
                 [10e-2 , -0.061e-3]; ...
                 [20e-2 , -0.095e-3]; ...
                 [30e-2 , -0.123e-3]; ...
                 [40e-2 , -0.324e-3]; ...
                 [50e-2 , -0.178e-3]; ...
                 [60e-2 , -0.168e-3]; ...
                 [70e-2 , -0.191e-3]; ...
                 [80e-2 , -0.249e-3]; ...
                 [85e-2 , -2.788e-3]; ...
                 [90e-2 , -1.297e-3]; ...
                 [100e-2, -0.954e-3]];
    
    dUdT = interpTable(dUdT_table(:, 1), dUdT_table(:, 2), theta);    
    
    % Calculate the open-circuit potential of the active material
   
    OCP = refOCP + (T - Tref).*dUdT;
    
end